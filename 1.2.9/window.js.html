

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: window.js | CodeSnippet</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 150px; height: 13px">
        
            <a href="https://github.com/nhnent/tui.jsdoc-template" rel="noopener noreferrer" target="_blank">
                <img src="https://cloud.githubusercontent.com/assets/12269563/20029815/01133928-a39a-11e6-80f3-12500a91c755.png" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">CodeSnippet</a></h1>
        
            <span class="version">v1.2.9</span>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="tui.util.CustomEvents.html">CustomEvents</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="tui.util.CustomEvents_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="tui.util.CustomEvents.html#contexts">contexts</a></li><li><a href="tui.util.CustomEvents.html#events">events</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="tui.util.CustomEvents.html#.mixin">mixin</a></li><li><a href="tui.util.CustomEvents.html#fire">fire</a></li><li><a href="tui.util.CustomEvents.html#getListenerLength">getListenerLength</a></li><li><a href="tui.util.CustomEvents.html#hasListener">hasListener</a></li><li><a href="tui.util.CustomEvents.html#invoke">invoke</a></li><li><a href="tui.util.CustomEvents.html#off">off</a></li><li><a href="tui.util.CustomEvents.html#on">on</a></li><li><a href="tui.util.CustomEvents.html#once">once</a></li></ul></div></li><li><a href="tui.util.Enum.html">Enum</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="tui.util.Enum_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="tui.util.Enum.html#getName">getName</a></li><li><a href="tui.util.Enum.html#set">set</a></li></ul></div></li><li><a href="tui.util.ExMap.html">ExMap</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="tui.util.ExMap_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="tui.util.ExMap.html#deleteByKeys">deleteByKeys</a></li><li><a href="tui.util.ExMap.html#filter">filter</a></li><li><a href="tui.util.ExMap.html#merge">merge</a></li><li><a href="tui.util.ExMap.html#setObject">setObject</a></li></ul></div></li><li><a href="tui.util.HashMap.html">HashMap</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="tui.util.HashMap_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="tui.util.HashMap.html#length">length</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="tui.util.HashMap.html#each">each</a></li><li><a href="tui.util.HashMap.html#find">find</a></li><li><a href="tui.util.HashMap.html#get">get</a></li><li><a href="tui.util.HashMap.html#has">has</a></li><li><a href="tui.util.HashMap.html#keys">keys</a></li><li><a href="tui.util.HashMap.html#merge">merge</a></li><li><a href="tui.util.HashMap.html#remove">remove</a></li><li><a href="tui.util.HashMap.html#removeAll">removeAll</a></li><li><a href="tui.util.HashMap.html#removeByKey">removeByKey</a></li><li><a href="tui.util.HashMap.html#removeByKeyArray">removeByKeyArray</a></li><li><a href="tui.util.HashMap.html#set">set</a></li><li><a href="tui.util.HashMap.html#setKeyValue">setKeyValue</a></li><li><a href="tui.util.HashMap.html#setObject">setObject</a></li><li><a href="tui.util.HashMap.html#toArray">toArray</a></li></ul></div></li><li><a href="tui.util.Map.html">Map</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="tui.util.Map_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="tui.util.Map.html#clear">clear</a></li><li><a href="tui.util.Map.html#delete">delete</a></li><li><a href="tui.util.Map.html#entries">entries</a></li><li><a href="tui.util.Map.html#forEach">forEach</a></li><li><a href="tui.util.Map.html#get">get</a></li><li><a href="tui.util.Map.html#has">has</a></li><li><a href="tui.util.Map.html#keys">keys</a></li><li><a href="tui.util.Map.html#set">set</a></li><li><a href="tui.util.Map.html#values">values</a></li></ul></div></li><li><a href="tui.util.Popup.html">Popup</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="tui.util.Popup_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="tui.util.Popup.html#closeWithParentPopup">closeWithParentPopup</a></li><li><a href="tui.util.Popup.html#openedPopup">openedPopup</a></li><li><a href="tui.util.Popup.html#postBridgeUrl">postBridgeUrl</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="tui.util.Popup.html#close">close</a></li><li><a href="tui.util.Popup.html#closeAllPopup">closeAllPopup</a></li><li><a href="tui.util.Popup.html#createForm">createForm</a></li><li><a href="tui.util.Popup.html#focus">focus</a></li><li><a href="tui.util.Popup.html#getPopupList">getPopupList</a></li><li><a href="tui.util.Popup.html#openPopup">openPopup</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Namespaces</h3><ul><li><a href="tui.util.html">tui.util</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="tui.util_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="tui.util.html#.browser">browser</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="tui.util.html#.bind">bind</a></li><li><a href="tui.util.html#.compareJSON">compareJSON</a></li><li><a href="tui.util.html#.createObject">createObject</a></li><li><a href="tui.util.html#.debounce">debounce</a></li><li><a href="tui.util.html#.decodeHTMLEntity">decodeHTMLEntity</a></li><li><a href="tui.util.html#.defineClass">defineClass</a></li><li><a href="tui.util.html#.defineModule">defineModule</a></li><li><a href="tui.util.html#.defineNamespace">defineNamespace</a></li><li><a href="tui.util.html#.encodeHTMLEntity">encodeHTMLEntity</a></li><li><a href="tui.util.html#.extend">extend</a></li><li><a href="tui.util.html#.filter">filter</a></li><li><a href="tui.util.html#.forEachOwnProperties">forEachOwnProperties</a></li><li><a href="tui.util.html#.formatDate">formatDate</a></li><li><a href="tui.util.html#.hasEncodableString">hasEncodableString</a></li><li><a href="tui.util.html#.hasStamp">hasStamp</a></li><li><a href="tui.util.html#.inArray">inArray</a></li><li><a href="tui.util.html#.inherit">inherit</a></li><li><a href="tui.util.html#.isArguments">isArguments</a></li><li><a href="tui.util.html#.isArray">isArray</a></li><li><a href="tui.util.html#.isArraySafe">isArraySafe</a></li><li><a href="tui.util.html#.isBoolean">isBoolean</a></li><li><a href="tui.util.html#.isBooleanSafe">isBooleanSafe</a></li><li><a href="tui.util.html#.isDate">isDate</a></li><li><a href="tui.util.html#.isDateSafe">isDateSafe</a></li><li><a href="tui.util.html#.isEmpty">isEmpty</a></li><li><a href="tui.util.html#.isExisty">isExisty</a></li><li><a href="tui.util.html#.isFalsy">isFalsy</a></li><li><a href="tui.util.html#.isFunction">isFunction</a></li><li><a href="tui.util.html#.isFunctionSafe">isFunctionSafe</a></li><li><a href="tui.util.html#.isHTMLNode">isHTMLNode</a></li><li><a href="tui.util.html#.isHTMLTag">isHTMLTag</a></li><li><a href="tui.util.html#.isNotEmpty">isNotEmpty</a></li><li><a href="tui.util.html#.isNull">isNull</a></li><li><a href="tui.util.html#.isNumber">isNumber</a></li><li><a href="tui.util.html#.isNumberSafe">isNumberSafe</a></li><li><a href="tui.util.html#.isObject">isObject</a></li><li><a href="tui.util.html#.isString">isString</a></li><li><a href="tui.util.html#.isStringSafe">isStringSafe</a></li><li><a href="tui.util.html#.isTruthy">isTruthy</a></li><li><a href="tui.util.html#.isUndefined">isUndefined</a></li><li><a href="tui.util.html#.keys">keys</a></li><li><a href="tui.util.html#.pick">pick</a></li><li><a href="tui.util.html#.pluck">pluck</a></li><li><a href="tui.util.html#.range">range</a></li><li><a href="tui.util.html#.reduce">reduce</a></li><li><a href="tui.util.html#.stamp">stamp</a></li><li><a href="tui.util.html#.throttle">throttle</a></li><li><a href="tui.util.html#.timestamp">timestamp</a></li><li><a href="tui.util.html#.toArray">toArray</a></li><li><a href="tui.util.html#.zip">zip</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview This module has some methods for handling popup-window
 * @author NHN Ent.
 *         FE Development Lab &lt;dl_javascript@nhnent.com>
 */

'use strict';

var collection = require('./collection');
var type = require('./type');
var func = require('./func');
var browser = require('./browser');
var object = require('./object');

var popupId = 0;

/**
 * Popup management class
 * @constructor
 * @memberof tui.util
 * @example
 * // node, commonjs
 * var popup = require('tui-code-snippet').popup;
 * @example
 * // distribution file, script
 * &lt;script src='path-to/tui-code-snippt.js'>&lt;/script>
 * &lt;script>
 * var popup = tui.util.popup;
 * &lt;script>
 */
function Popup() {
    /**
     * Caching the window-contexts of opened popups
     * @type {Object}
     */
    this.openedPopup = {};

    /**
     * In IE7, an error occurs when the closeWithParent property attaches to window object.&lt;br>
     * So, It is for saving the value of closeWithParent instead of attaching to window object.
     * @type {Object}
     */
    this.closeWithParentPopup = {};

    /**
     * Post data bridge for IE11 popup
     * @type {string}
     */
    this.postBridgeUrl = '';
}

/**********
 * public methods
 **********/

/**
 * Returns a popup-list administered by current window.
 * @param {string} [key] The key of popup.
 * @returns {Object} popup window list object
 */
Popup.prototype.getPopupList = function(key) {
    var target;
    if (type.isExisty(key)) {
        target = this.openedPopup[key];
    } else {
        target = this.openedPopup;
    }

    return target;
};

/**
 * Open popup
 * Caution:
 *  In IE11, when transfer data to popup by POST, must set the postBridgeUrl.
 *
 * @param {string} url - popup url
 * @param {Object} options - popup options
 *     @param {string} [options.popupName] - Key of popup window.&lt;br>
 *      If the key is set, when you try to open by this key, the popup of this key is focused.&lt;br>
 *      Or else a new popup window having this key is opened.
 *
 *     @param {string} [options.popupOptionStr=""] - Option string of popup window&lt;br>
 *      It is same with the third parameter of window.open() method.&lt;br>
 *      See {@link http://www.w3schools.com/jsref/met_win_open.asp}
 *
 *     @param {boolean} [options.closeWithParent=true] - Is closed when parent window closed?
 *
 *     @param {boolean} [options.useReload=false] - This property indicates whether reload the popup or not.&lt;br>
 *      If true, the popup will be reloaded when you try to re-open the popup that has been opened.&lt;br>
 *      When transmit the POST-data, some browsers alert a message for confirming whether retransmit or not.
 *
 *     @param {string} [options.postBridgeUrl='']
 *      Use this url to avoid a certain bug occuring when transmitting POST data to the popup in IE11.&lt;br>
 *      This specific buggy situation is known to happen because IE11 tries to open the requested url&lt;br>
 *      not in a new popup window as intended, but in a new tab.&lt;br>
 *      See {@link http://wiki.nhnent.com/pages/viewpage.action?pageId=240562844}
 *
 *     @param {string} [options.method=get]
 *     The method of transmission when the form-data is transmitted to popup-window.
 *
 *     @param {Object} [options.param=null]
 *     Using as parameters for transmission when the form-data is transmitted to popup-window.
 */
Popup.prototype.openPopup = function(url, options) { // eslint-disable-line complexity
    var popup, formElement, useIEPostBridge;

    options = object.extend({
        popupName: 'popup_' + popupId + '_' + Number(new Date()),
        popupOptionStr: '',
        useReload: true,
        closeWithParent: true,
        method: 'get',
        param: {}
    }, options || {});

    options.method = options.method.toUpperCase();

    this.postBridgeUrl = options.postBridgeUrl || this.postBridgeUrl;

    useIEPostBridge = options.method === 'POST' &amp;&amp; options.param &amp;&amp;
            browser.msie &amp;&amp; browser.version === 11;

    if (!type.isExisty(url)) {
        throw new Error('Popup#open() need popup url.');
    }

    popupId += 1;

    /*
     * In form-data transmission
     * 1. Create a form before opening a popup.
     * 2. Transmit the form-data.
     * 3. Remove the form after transmission.
     */
    if (options.param) {
        if (options.method === 'GET') {
            url = url + (/\?/.test(url) ? '&amp;' : '?') + this._parameterize(options.param);
        } else if (options.method === 'POST') {
            if (!useIEPostBridge) {
                formElement = this.createForm(url, options.param, options.method, options.popupName);
                url = 'about:blank';
            }
        }
    }

    popup = this.openedPopup[options.popupName];

    if (!type.isExisty(popup)) {
        this.openedPopup[options.popupName] = popup = this._open(useIEPostBridge, options.param,
            url, options.popupName, options.popupOptionStr);
    } else if (popup.closed) {
        this.openedPopup[options.popupName] = popup = this._open(useIEPostBridge, options.param,
            url, options.popupName, options.popupOptionStr);
    } else {
        if (options.useReload) {
            popup.location.replace(url);
        }
        popup.focus();
    }

    this.closeWithParentPopup[options.popupName] = options.closeWithParent;

    if (!popup || popup.closed || type.isUndefined(popup.closed)) {
        alert('please enable popup windows for this website');
    }

    if (options.param &amp;&amp; options.method === 'POST' &amp;&amp; !useIEPostBridge) {
        if (popup) {
            formElement.submit();
        }
        if (formElement.parentNode) {
            formElement.parentNode.removeChild(formElement);
        }
    }

    window.onunload = func.bind(this.closeAllPopup, this);
};

/**
 * Close the popup
 * @param {boolean} [skipBeforeUnload] - If true, the 'window.onunload' will be null and skip unload event.
 * @param {Window} [popup] - Window-context of popup for closing. If omit this, current window-context will be closed.
 */
Popup.prototype.close = function(skipBeforeUnload, popup) {
    var target = popup || window;
    skipBeforeUnload = type.isExisty(skipBeforeUnload) ? skipBeforeUnload : false;

    if (skipBeforeUnload) {
        window.onunload = null;
    }

    if (!target.closed) {
        target.opener = window.location.href;
        target.close();
    }
};

/**
 * Close all the popups in current window.
 * @param {boolean} closeWithParent - If true, popups having the closeWithParentPopup property as true will be closed.
 */
Popup.prototype.closeAllPopup = function(closeWithParent) {
    var hasArg = type.isExisty(closeWithParent);

    collection.forEachOwnProperties(this.openedPopup, function(popup, key) {
        if ((hasArg &amp;&amp; this.closeWithParentPopup[key]) || !hasArg) {
            this.close(false, popup);
        }
    }, this);
};

/**
 * Activate(or focus) the popup of the given name.
 * @param {string} popupName - Name of popup for activation
 */
Popup.prototype.focus = function(popupName) {
    this.getPopupList(popupName).focus();
};

/**
 * Return an object made of parsing the query string.
 * @returns {Object} An object having some information of the query string.
 * @private
 */
Popup.prototype.parseQuery = function() {
    var param = {};
    var search, pair;

    search = window.location.search.substr(1);
    collection.forEachArray(search.split('&amp;'), function(part) {
        pair = part.split('=');
        param[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
    });

    return param;
};

/**
 * Create a hidden form from the given arguments and return this form.
 * @param {string} action - URL for form transmission
 * @param {Object} [data] - Data for form transmission
 * @param {string} [method] - Method of transmission
 * @param {string} [target] - Target of transmission
 * @param {HTMLElement} [container] - Container element of form.
 * @returns {HTMLElement} Form element
 */
Popup.prototype.createForm = function(action, data, method, target, container) {
    var form = document.createElement('form'),
        input;

    container = container || document.body;

    form.method = method || 'POST';
    form.action = action || '';
    form.target = target || '';
    form.style.display = 'none';

    collection.forEachOwnProperties(data, function(value, key) {
        input = document.createElement('input');
        input.name = key;
        input.type = 'hidden';
        input.value = value;
        form.appendChild(input);
    });

    container.appendChild(form);

    return form;
};

/**********
 * private methods
 **********/

/**
 * Return an query string made by parsing the given object
 * @param {Object} obj - An object that has information for query string
 * @returns {string} - Query string
 * @private
 */
Popup.prototype._parameterize = function(obj) {
    var query = [];

    collection.forEachOwnProperties(obj, function(value, key) {
        query.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));
    });

    return query.join('&amp;');
};

/**
 * Open popup
 * @param {boolean} useIEPostBridge - A switch option whether to use alternative
 *                                  of tossing POST data to the popup window in IE11
 * @param {Object} param - A data for tossing to popup
 * @param {string} url - Popup url
 * @param {string} popupName - Popup name
 * @param {string} optionStr - Setting for popup, ex) 'width=640,height=320,scrollbars=yes'
 * @returns {Window} Window context of popup
 * @private
 */
Popup.prototype._open = function(useIEPostBridge, param, url, popupName, optionStr) {
    var popup;

    if (useIEPostBridge) {
        popup = window.open(this.postBridgeUrl, popupName, optionStr);
        setTimeout(function() {
            popup.redirect(url, param);
        }, 100);
    } else {
        popup = window.open(url, popupName, optionStr);
    }

    return popup;
};

module.exports = new Popup();
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://cloud.githubusercontent.com/assets/12269563/20029815/01133928-a39a-11e6-80f3-12500a91c755.png" style="width: 150px; height: 13px">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
